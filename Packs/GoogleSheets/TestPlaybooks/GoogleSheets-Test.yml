id: GoogleSheets-Test
version: -1
vcShouldKeepItemLegacyProdMachine: false
name: GoogleSheets-Test
description: Test play book for all the GoogleSheets commands - Notice the last task is from Google Drive integration to delete the created file
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 06797aee-e22a-4a21-8ab3-4264637acec6
    type: start
    task:
      id: 06797aee-e22a-4a21-8ab3-4264637acec6
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: a3aec899-ebd7-45ed-80e8-fd1a89d40b4c
    type: regular
    task:
      id: a3aec899-ebd7-45ed-80e8-fd1a89d40b4c
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 7d5d3724-2b6a-411b-88d5-5acf6d6b225f
    type: regular
    task:
      id: 7d5d3724-2b6a-411b-88d5-5acf6d6b225f
      version: -1
      name: google-sheets-spreadsheet-create
      description: Create a new Spreadsheet
      script: GoogleSheets|||google-sheets-spreadsheet-create
      type: regular
      iscommand: true
      brand: GoogleSheets
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      cell_format_type:
        simple: TEXT
      sheet_title:
        simple: Sheet1
      sheet_type:
        simple: GRID
      title:
        simple: PlayBook-Spreadsheet
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 3b63ad61-f5ae-48c1-8c47-20e57c1a1c43
    type: regular
    task:
      id: 3b63ad61-f5ae-48c1-8c47-20e57c1a1c43
      version: -1
      name: google-sheets-spreadsheet-get
      description: Returns the spreadsheet at the given ID
      script: GoogleSheets|||google-sheets-spreadsheet-get
      type: regular
      iscommand: true
      brand: GoogleSheets
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      spreadsheet_id:
        simple: ${Spreadsheet.spreadsheetId}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 33300ae1-82ac-4f6c-8b86-38fc0cc70ff7
    type: regular
    task:
      id: 33300ae1-82ac-4f6c-8b86-38fc0cc70ff7
      version: -1
      name: google-sheets-sheet-create
      description: Adds a new sheet. When a sheet is added at a given index, all subsequent
        sheets' indexes are incremented
      script: GoogleSheets|||google-sheets-sheet-create
      type: regular
      iscommand: true
      brand: GoogleSheets
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      echo_spreadsheet:
        simple: "false"
      sheet_id:
        simple: "5"
      sheet_index:
        simple: "1"
      sheet_title:
        simple: Sheet2
      spreadsheet_id:
        simple: ${Spreadsheet.spreadsheetId}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 680
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 88fcc2ba-655d-4435-8e99-6b590409dcfe
    type: regular
    task:
      id: 88fcc2ba-655d-4435-8e99-6b590409dcfe
      version: -1
      name: google-sheets-value-update
      description: Sets values in a range of a spreadsheet. The caller must specify
        the spreadsheet ID, range, and a valueInputOption.
      script: GoogleSheets|||google-sheets-value-update
      type: regular
      iscommand: true
      brand: GoogleSheets
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      input_option:
        simple: RAW
      major_dimension:
        simple: ROWS
      range:
        simple: Sheet1!A1:D8
      spreadsheet_id:
        simple: ${Spreadsheet.spreadsheetId}
      values:
        simple: '[1,2,3],[4,5,6]'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1085
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 365f245a-6e36-475d-88e8-b1c188430a27
    type: regular
    task:
      id: 365f245a-6e36-475d-88e8-b1c188430a27
      version: -1
      name: google-sheets-sheet-copy-to
      description: Copies a single sheet from a spreadsheet to another spreadsheet
      script: GoogleSheets|||google-sheets-sheet-copy-to
      type: regular
      iscommand: true
      brand: GoogleSheets
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      destination_spreadsheet_id:
        simple: ${Spreadsheet.spreadsheetId}
      source_sheet_id:
        complex:
          root: Spreadsheet.sheets.properties
          accessor: sheetId
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "1"
      source_spreadsheet_id:
        simple: ${Spreadsheet.spreadsheetId}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 21958cbc-8974-46c1-8c93-caf1a1618732
    type: regular
    task:
      id: 21958cbc-8974-46c1-8c93-caf1a1618732
      version: -1
      name: google-sheets-spreadsheet-get
      description: Returns the spreadsheet at the given ID
      script: GoogleSheets|||google-sheets-spreadsheet-get
      type: regular
      iscommand: true
      brand: GoogleSheets
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      spreadsheet_id:
        complex:
          root: Spreadsheet
          accessor: spreadsheetId
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 3880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: d10842c9-6d90-4944-8f86-89b69d2d04c8
    type: regular
    task:
      id: d10842c9-6d90-4944-8f86-89b69d2d04c8
      version: -1
      name: google-sheets-sheet-duplicate
      description: Duplicates the contents of a sheet
      script: GoogleSheets|||google-sheets-sheet-duplicate
      type: regular
      iscommand: true
      brand: GoogleSheets
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      new_sheet_index:
        simple: "0"
      new_sheet_name:
        simple: duplicatedSheet
      source_sheet_id:
        complex:
          root: Spreadsheet.sheets.properties
          accessor: sheetId
          transformers:
          - operator: FirstArrayElement
      spreadsheet_id:
        simple: ${Spreadsheet.spreadsheetId}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2080
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 33e3229f-3f4a-4e67-8bb3-49005c5808c2
    type: regular
    task:
      id: 33e3229f-3f4a-4e67-8bb3-49005c5808c2
      version: -1
      name: google-sheets-sheet-delete
      description: Delete a sheet from a spreadsheet by id
      script: GoogleSheets|||google-sheets-sheet-delete
      type: regular
      iscommand: true
      brand: GoogleSheets
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      echo_spreadsheet:
        simple: "false"
      sheet_id:
        complex:
          root: Spreadsheet.sheets.properties
          accessor: sheetId
          transformers:
          - operator: FirstArrayElement
      spreadsheet_id:
        complex:
          root: Spreadsheet
          accessor: spreadsheetId
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 4140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: c695d173-627f-49f9-8790-32948d977121
    type: regular
    task:
      id: c695d173-627f-49f9-8790-32948d977121
      version: -1
      name: google-sheets-value-append
      description: Appends values to a spreadsheet. The input range is used to search
        for existing data and find a "table" within that range. Values will be appended
        to the next row of the table, starting with the first column of the table.
        See the guide and sample code for specific details of how tables are detected
        and data is appended.  The caller must specify the spreadsheet ID, range,
        and a valueInputOption. The valueInputOption only controls how the input data
        will be added to the sheet (column-wise or row-wise), it does not influence
        what cell the data starts being written to.
      script: GoogleSheets|||google-sheets-value-append
      type: regular
      iscommand: true
      brand: GoogleSheets
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      input_option:
        simple: RAW
      insert_option:
        simple: INSERT_ROWS
      major_dimension:
        simple: ROWS
      range:
        simple: Sheet1!A1:D8
      spreadsheet_id:
        complex:
          root: Spreadsheet
          accessor: spreadsheetId
          transformers:
          - operator: FirstArrayElement
      values:
        simple: '[7,7,7],[7,7,7]'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: b80909f9-15a3-46e0-82f0-3eabcbc6904d
    type: regular
    task:
      id: b80909f9-15a3-46e0-82f0-3eabcbc6904d
      version: -1
      name: google-sheets-find-replace
      description: Finds and replaces data in cells over a range, sheet, or all sheets.
      script: GoogleSheets|||google-sheets-find-replace
      type: regular
      iscommand: true
      brand: GoogleSheets
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      all_sheets:
        simple: "True"
      find:
        simple: "7"
      match_case:
        simple: "False"
      match_entire_cell:
        simple: "False"
      replacement:
        simple: '@@'
      spreadsheet_id:
        complex:
          root: Spreadsheet
          accessor: spreadsheetId
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: e3b5bd4c-3108-48b9-8102-17bba94132ef
    type: regular
    task:
      id: e3b5bd4c-3108-48b9-8102-17bba94132ef
      version: -1
      name: google-sheets-range-delete
      description: Deletes a range of cells, shifting other cells into the deleted
        area.
      script: GoogleSheets|||google-sheets-range-delete
      type: regular
      iscommand: true
      brand: GoogleSheets
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      end_column_index:
        simple: "3"
      end_row_index:
        simple: "3"
      sheet_id:
        complex:
          root: Spreadsheet.sheets.properties
          accessor: sheetId
          transformers:
          - operator: FirstArrayElement
      shift_dimension:
        simple: ROWS
      spreadsheet_id:
        complex:
          root: Spreadsheet
          accessor: spreadsheetId
          transformers:
          - operator: FirstArrayElement
      start_column_index:
        simple: "0"
      start_row_index:
        simple: "0"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: a5e38809-49c5-4449-86ac-601cae0d60e4
    type: regular
    task:
      id: a5e38809-49c5-4449-86ac-601cae0d60e4
      version: -1
      name: google-sheets-sheet-clear
      description: Clears values from a spreadsheet. The caller must specify the spreadsheet
        ID and range. Only values are cleared -- all other properties of the cell
        (such as formatting, data validation, etc..) are kept.
      script: GoogleSheets|||google-sheets-sheet-clear
      type: regular
      iscommand: true
      brand: GoogleSheets
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      range:
        simple: Sheet1!A1:D8
      spreadsheet_id:
        complex:
          root: Spreadsheet
          accessor: spreadsheetId
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2555
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: c8e2b62b-873f-409b-853e-26961d916fba
    type: regular
    task:
      id: c8e2b62b-873f-409b-853e-26961d916fba
      version: -1
      name: google-sheets-data-paste
      description: Inserts data into the spreadsheet starting at the specified coordinate.
      script: GoogleSheets|||google-sheets-data-paste
      type: regular
      iscommand: true
      brand: GoogleSheets
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      column_index:
        simple: "10"
      data:
        simple: 1,2,3,4,5,6
      data_kind:
        simple: delimiter
      paste_type:
        simple: NORMAL
      row_index:
        simple: "10"
      sheet_id:
        complex:
          root: Spreadsheet.sheets.properties
          accessor: sheetId
          transformers:
          - operator: FirstArrayElement
      spreadsheet_id:
        complex:
          root: Spreadsheet
          accessor: spreadsheetId
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 3325
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 0399753e-6817-40a0-8847-5dcc6480c283
    type: regular
    task:
      id: 0399753e-6817-40a0-8847-5dcc6480c283
      version: -1
      name: google-sheets-dimension-delete
      description: Deletes the dimensions from the sheet. notice the indexing starts
        from 0
      script: GoogleSheets|||google-sheets-dimension-delete
      type: regular
      iscommand: true
      brand: GoogleSheets
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      dimension_type:
        simple: ROWS
      dimention_type:
        simple: ROWS
      end_index:
        simple: "2"
      sheet_id:
        complex:
          root: Spreadsheet.sheets.properties
          accessor: sheetId
          transformers:
          - operator: FirstArrayElement
      spreadsheet_id:
        complex:
          root: Spreadsheet
          accessor: spreadsheetId
          transformers:
          - operator: FirstArrayElement
      start_index:
        simple: "0"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 682d1737-6604-4b36-8cb5-86e34c8d8e95
    type: regular
    task:
      id: 682d1737-6604-4b36-8cb5-86e34c8d8e95
      version: -1
      name: google-sheets-spreadsheet-get
      description: Returns the spreadsheet at the given ID
      script: GoogleSheets|||google-sheets-spreadsheet-get
      type: regular
      iscommand: true
      brand: GoogleSheets
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      spreadsheet_id:
        simple: ${Spreadsheet.spreadsheetId}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 4390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 7c427882-b18d-4576-8578-769442ceb658
    type: regular
    task:
      id: 7c427882-b18d-4576-8578-769442ceb658
      version: -1
      name: google-sheets-spreadsheet-update
      description: Applies one or more updates to the spreadsheet.  Each request is
        validated before being applied. If any request is not valid then the entire
        request will fail and nothing will be applied.
      script: GoogleSheets|||google-sheets-spreadsheet-update
      type: regular
      iscommand: true
      brand: GoogleSheets
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      requests:
        simple: |-
          {
            "requests": [
              {
                "copyPaste": {
                  "source": {
                    "sheetId": 5,
                    "startColumnIndex": 0,
                    "endColumnIndex": 3,
                    "startRowIndex": 0,
                    "endRowIndex": 3
                  },
                  "destination": {
                    "sheetId": 5,
                    "startColumnIndex": 5,
                    "startRowIndex": 5,
                    "endColumnIndex": 8,
                    "endRowIndex": 8
                  },
                  "pasteOrientation": "TRANSPOSE"
                }
              }
            ]
          }
      spreadsheet_id:
        complex:
          root: Spreadsheet
          accessor: spreadsheetId
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: d27a8841-88ff-464c-8dde-783150cb1222
    type: regular
    task:
      id: d27a8841-88ff-464c-8dde-783150cb1222
      version: -1
      name: google-drive-file-delete
      description: Permanently deletes a file owned by the user without moving it
        to the trash. If the file belongs to a shared drive the user must be an organizer
        on the parent. If the target is a folder, all descendants owned by the user
        are also deleted.
      script: GoogleDrive|||google-drive-file-delete
      type: regular
      iscommand: true
      brand: GoogleDrive
    scriptarguments:
      file_id:
        simple: ${Spreadsheet.spreadsheetId}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 4660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 4705,
        "width": 380,
        "x": 450,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
tests:
- No tests (auto formatted)
fromversion: 6.1.0

