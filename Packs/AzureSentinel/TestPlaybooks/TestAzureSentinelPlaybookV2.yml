id: TestAzureSentinelPlaybookV2
version: -1
name: TestAzureSentinelPlaybookV2
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 436c118a-5b82-40b5-862b-d0d47b6d5193
    type: start
    task:
      id: 436c118a-5b82-40b5-862b-d0d47b6d5193
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": -50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 993bebc3-e366-4a82-8635-410063a52976
    type: regular
    task:
      id: 993bebc3-e366-4a82-8635-410063a52976
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "35"
      - "43"
      - "4"
      - "19"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 105
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 16a911e3-679a-4c60-8038-2fbd77fd4e45
    type: regular
    task:
      id: 16a911e3-679a-4c60-8038-2fbd77fd4e45
      version: -1
      name: azure-sentinel-get-incident-by-id
      script: '|||azure-sentinel-get-incident-by-id'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      incident_id:
        simple: ${AzureSentinel.Incident.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 94f6ab06-71b3-4548-8f45-6e798e129533
    type: condition
    task:
      id: 94f6ab06-71b3-4548-8f45-6e798e129533
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureSentinel.Incident.ID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: AzureSentinel.Incident.Title
            iscontext: true
          right:
            value:
              simple: DO_NOT_TOUCH-FOR_TEST_PLAYBOOK
      - - operator: isEqualString
          left:
            value:
              simple: AzureSentinel.Incident.Severity
            iscontext: true
          right:
            value:
              simple: Medium
      - - operator: isEqualString
          left:
            value:
              simple: AzureSentinel.Incident.Status
            iscontext: true
          right:
            value:
              simple: Active
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 08f00d04-33a0-44da-83b9-6e943f3b4054
    type: regular
    task:
      id: 08f00d04-33a0-44da-83b9-6e943f3b4054
      version: -1
      name: azure-sentinel-list-incidents
      script: '|||azure-sentinel-list-incidents'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      filter:
        simple: properties/title eq '${inputs.incident_title}'
      top:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 88994085-6e37-4890-87d9-ef8b852a7b8d
    type: condition
    task:
      id: 88994085-6e37-4890-87d9-ef8b852a7b8d
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "2"
      - "30"
      - "31"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureSentinel.Incident.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureSentinel.Incident.Title
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureSentinel.Incident.Severity
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureSentinel.Incident.Status
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureSentinel.Incident.CreatedTimeUTC
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureSentinel.Incident.IncidentNumber
            iscontext: true
      - - operator: isNotExists
          left:
            value:
              simple: AzureSentinel.NextLink
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 7e1cfc0c-3568-4ab4-821f-0c647aba290e
    type: regular
    task:
      id: 7e1cfc0c-3568-4ab4-821f-0c647aba290e
      version: -1
      name: azure-sentinel-update-incident
      script: '|||azure-sentinel-update-incident'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      description:
        simple: test_description
      incident_id:
        simple: ${AzureSentinel.Incident.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 4ae2a4d4-7f45-40a5-864b-1df4865dd62a
    type: condition
    task:
      id: 4ae2a4d4-7f45-40a5-864b-1df4865dd62a
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: AzureSentinel.Incident.Severity
            iscontext: true
          right:
            value:
              simple: Medium
      - - operator: isEqualString
          left:
            value:
              simple: AzureSentinel.Incident.Description
            iscontext: true
          right:
            value:
              simple: test_description
      - - operator: isEqualString
          left:
            value:
              simple: AzureSentinel.Incident.Status
            iscontext: true
          right:
            value:
              simple: Active
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 72a734b8-f23e-420c-82c5-0eb4a83f8957
    type: regular
    task:
      id: 72a734b8-f23e-420c-82c5-0eb4a83f8957
      version: -1
      name: azure-sentinel-list-incident-comments
      script: '|||azure-sentinel-list-incident-comments'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      incident_id:
        simple: ${AzureSentinel.Incident.ID}
      top:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1805
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 95fd8629-946b-4482-89bf-fbe66ed8c738
    type: condition
    task:
      id: 95fd8629-946b-4482-89bf-fbe66ed8c738
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "34"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureSentinel.IncidentComment
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: b1a4fc8a-19a6-4bce-8fb3-e31c263b26c9
    type: regular
    task:
      id: b1a4fc8a-19a6-4bce-8fb3-e31c263b26c9
      version: -1
      name: azure-sentinel-incident-add-comment
      script: '|||azure-sentinel-incident-add-comment'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      incident_id:
        simple: ${AzureSentinel.Incident.ID}
      message:
        simple: ${inputs.test_comment}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1455
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: fcbc42ee-3dfd-4e3e-81a0-36df39ce5f9c
    type: condition
    task:
      id: fcbc42ee-3dfd-4e3e-81a0-36df39ce5f9c
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureSentinel.IncidentComment.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureSentinel.IncidentComment.IncidentID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: AzureSentinel.IncidentComment.Message
            iscontext: true
          right:
            value:
              simple: ${inputs.test_comment}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 5937b04d-6383-40b2-86fe-2cea1ecd5ce1
    type: regular
    task:
      id: 5937b04d-6383-40b2-86fe-2cea1ecd5ce1
      version: -1
      name: azure-sentinel-list-incident-relations
      script: '|||azure-sentinel-list-incident-relations'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      entity_kinds:
        simple: SecurityAlert
      incident_id:
        simple: ${AzureSentinel.Incident.ID}
      top:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: ee77b7b4-e84f-4e1c-87fe-ae5380715398
    type: condition
    task:
      id: ee77b7b4-e84f-4e1c-87fe-ae5380715398
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureSentinel.IncidentRelatedResource.ID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: AzureSentinel.IncidentRelatedResource.Kind
            iscontext: true
          right:
            value:
              simple: SecurityAlert
      - - operator: isEqualString
          left:
            value:
              simple: AzureSentinel.IncidentRelatedResource.IncidentID
            iscontext: true
          right:
            value:
              simple: AzureSentinel.Incident.ID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 9b023f4e-6a84-495a-8b6a-f82430a105cf
    type: title
    task:
      id: 9b023f4e-6a84-495a-8b6a-f82430a105cf
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: b6f1b397-d417-4f17-8510-1f05f0da4ef5
    type: regular
    task:
      id: b6f1b397-d417-4f17-8510-1f05f0da4ef5
      version: -1
      name: Create file
      description: |
        Will create a file (using the given data input or entry ID) and upload it to current investigation war room.
      scriptName: FileCreateAndUpload
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      data:
        simple: |-
          name,IP
          test_name_1,1.2.3.4
          test_name_2,1.2.3.5
      filename:
        simple: csv_file
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 2f6b4040-609d-4591-80bc-2d4503573a23
    type: regular
    task:
      id: 2f6b4040-609d-4591-80bc-2d4503573a23
      version: -1
      name: azure-sentinel-watchlist-create-update
      description: Create or update a watchlists in Azure Sentinel.
      script: '|||azure-sentinel-watchlist-create-update'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      file_entry_id:
        simple: ${File.EntryID}
      items_search_key:
        simple: IP
      watchlist_alias:
        simple: ${inputs.watchlist_alias}
      watchlist_display_name:
        simple: ${inputs.watchlist_alias}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 2eb863d4-0b91-42ff-8d74-9a51b0490966
    type: condition
    task:
      id: 2eb863d4-0b91-42ff-8d74-9a51b0490966
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "22"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: AzureSentinel.Watchlist.Alias
            iscontext: true
          right:
            value:
              simple: ${inputs.watchlist_alias}
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: c282bee9-28df-4fff-8d62-1769b3cb3158
    type: regular
    task:
      id: c282bee9-28df-4fff-8d62-1769b3cb3158
      version: -1
      name: azure-sentinel-list-watchlists
      description: Gets a list of watchlists from Azure Sentinel.
      script: '|||azure-sentinel-list-watchlists'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      watchlist_alias:
        simple: ${inputs.watchlist_alias}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 10c64387-9946-4919-8e16-a1c0ea24efc0
    type: condition
    task:
      id: 10c64387-9946-4919-8e16-a1c0ea24efc0
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: AzureSentinel.Watchlist.Alias
            iscontext: true
          right:
            value:
              simple: ${inputs.watchlist_alias}
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: d6f23e4f-0fdf-4a56-8b44-56270f2351af
    type: regular
    task:
      id: d6f23e4f-0fdf-4a56-8b44-56270f2351af
      version: -1
      name: azure-sentinel-create-update-watchlist-item
      description: Create or update a watchlist item.
      script: Azure Sentinel|||azure-sentinel-create-update-watchlist-item
      type: regular
      iscommand: true
      brand: Azure Sentinel
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      item_key_value:
        simple: '{"name": "test_playbook_item", "IP": "1.1.1.1"}'
      watchlist_alias:
        simple: ${inputs.watchlist_alias}
      watchlist_item_id:
        simple: 4fe24647-7aad-4dc8-9530-4e110ea858c1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: e6e932c3-5dfa-4456-84a6-1d7384d05b58
    type: regular
    task:
      id: e6e932c3-5dfa-4456-84a6-1d7384d05b58
      version: -1
      name: azure-sentinel-list-watchlist-items
      description: Get a single watchlist item or list of watchlist items.
      script: Azure Sentinel|||azure-sentinel-list-watchlist-items
      type: regular
      iscommand: true
      brand: Azure Sentinel
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      watchlist_alias:
        simple: ${inputs.watchlist_alias}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 9d2138a2-4101-445b-8d66-e8174477fbc0
    type: condition
    task:
      id: 9d2138a2-4101-445b-8d66-e8174477fbc0
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: AzureSentinel.WatchlistItem.WatchlistAlias
            iscontext: true
          right:
            value:
              simple: ${inputs.watchlist_alias}
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureSentinel.WatchlistItem
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: b3a8110b-626a-4fa7-81e5-e66392b0176c
    type: regular
    task:
      id: b3a8110b-626a-4fa7-81e5-e66392b0176c
      version: -1
      name: azure-sentinel-delete-watchlist-item
      description: Delete a watchlist item.
      script: '|||azure-sentinel-delete-watchlist-item'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      watchlist_alias:
        simple: ${inputs.watchlist_alias}
      watchlist_item_id:
        simple: ${AzureSentinel.WatchlistItem.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: ea5f9a12-7547-4b36-8515-7e2f8645ee42
    type: regular
    task:
      id: ea5f9a12-7547-4b36-8515-7e2f8645ee42
      version: -1
      name: azure-sentinel-delete-watchlist
      description: Delete a watchlists from Azure Sentinel.
      script: '|||azure-sentinel-delete-watchlist'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      watchlist_alias:
        simple: ${inputs.watchlist_alias}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 3254e40c-d03d-4ec3-8fd9-e4bc999372ef
    type: regular
    task:
      id: 3254e40c-d03d-4ec3-8fd9-e4bc999372ef
      version: -1
      name: azure-sentinel-list-incident-alerts
      description: Gets a list of an incident's alerts from Azure Sentinel.
      script: '|||azure-sentinel-list-incident-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      incident_id:
        simple: ${AzureSentinel.Incident.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: de24cd08-ef7c-4424-8057-1438ef8b20c4
    type: regular
    task:
      id: de24cd08-ef7c-4424-8057-1438ef8b20c4
      version: -1
      name: azure-sentinel-list-incident-entities
      description: Gets a list of an incident's entities from Azure Sentinel.
      script: '|||azure-sentinel-list-incident-entities'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      incident_id:
        simple: ${AzureSentinel.Incident.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: c1445fb8-983b-4b43-83e3-03c35c7cb437
    type: condition
    task:
      id: c1445fb8-983b-4b43-83e3-03c35c7cb437
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEmpty
          left:
            value:
              simple: AzureSentinel.IncidentEntity
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: a22fd849-21ae-4849-8097-b8aa99c49118
    type: condition
    task:
      id: a22fd849-21ae-4849-8097-b8aa99c49118
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: hasLength
          left:
            value:
              simple: AzureSentinel.IncidentAlert
            iscontext: true
          right:
            value:
              simple: "1"
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: d8e534e1-762f-4ca8-8798-9690aeadd9ed
    type: regular
    task:
      id: d8e534e1-762f-4ca8-8798-9690aeadd9ed
      version: -1
      name: Delete comment
      description: Deletes a single comment from incident in Azure Sentinel.
      script: Azure Sentinel|||azure-sentinel-incident-delete-comment
      type: regular
      iscommand: true
      brand: Azure Sentinel
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      comment_id:
        simple: ${AzureSentinel.IncidentComment.ID}
      incident_id:
        simple: ${AzureSentinel.Incident.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 2d92e50f-a52b-433c-8089-f915bc4344dd
    type: regular
    task:
      id: 2d92e50f-a52b-433c-8089-f915bc4344dd
      version: -1
      name: azure-sentinel-threat-indicator-list
      description: list_threat_indicator_command returns a list of threat indicators
      script: Azure Sentinel|||azure-sentinel-threat-indicator-list
      type: regular
      iscommand: true
      brand: Azure Sentinel
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1820,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 36667f9d-773f-4ac3-8dc5-60e8775fccc0
    type: condition
    task:
      id: 36667f9d-773f-4ac3-8dc5-60e8775fccc0
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "37"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureSentinel.ThreatIndicator.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureSentinel.ThreatIndicator.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureSentinel.ThreatIndicator.ETag
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureSentinel.ThreatIndicator.Type
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1820,
          "y": 525
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 4fe83941-6e2e-4fdc-8433-d8b488e6aa23
    type: regular
    task:
      id: 4fe83941-6e2e-4fdc-8433-d8b488e6aa23
      version: -1
      name: azure-sentinel-threat-indicator-query
      description: query_threat_indicators_command returns a list of threat indicators
        with specific entities
      script: Azure Sentinel|||azure-sentinel-threat-indicator-query
      type: regular
      iscommand: true
      brand: Azure Sentinel
    nexttasks:
      '#none#':
      - "38"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1820,
          "y": 700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 560a24d9-1bc1-45c8-8c30-a7b40a7553a8
    type: condition
    task:
      id: 560a24d9-1bc1-45c8-8c30-a7b40a7553a8
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "39"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureSentinel.ThreatIndicator.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureSentinel.ThreatIndicator.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureSentinel.ThreatIndicator.ETag
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureSentinel.ThreatIndicator.Type
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1820,
          "y": 850
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 3b4957e6-d08d-48fc-8f99-fb6c6fad1cf3
    type: regular
    task:
      id: 3b4957e6-d08d-48fc-8f99-fb6c6fad1cf3
      version: -1
      name: |
        azure-sentinel-threat-indicator-create
      description: creates a new threat indicator
      script: '|||azure-sentinel-threat-indicator-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      display_name:
        simple: test
      indicator_type:
        simple: domain
      threat_types:
        simple: benign
      value:
        simple: test.test
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1820,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: be24c118-4e16-465d-8b0b-b16f490b8e44
    type: condition
    task:
      id: be24c118-4e16-465d-8b0b-b16f490b8e44
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "42"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: AzureSentinel.ThreatIndicator.DisplayName
            iscontext: true
          right:
            value:
              simple: test
    view: |-
      {
        "position": {
          "x": 1820,
          "y": 1200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 14a665e5-d6bd-44e8-80b8-7c973ac55d5b
    type: regular
    task:
      id: 14a665e5-d6bd-44e8-80b8-7c973ac55d5b
      version: -1
      name: |
        azure-sentinel-threat-indicator-create
      description: creates a new threat indicator
      script: '|||azure-sentinel-threat-indicator-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      display_name:
        simple: test
      indicator_type:
        simple: domain
      threat_types:
        simple: benign
      value:
        simple: test.test
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1820,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 402d819e-537a-4905-8bc5-eea0ad2803e5
    type: regular
    task:
      id: 402d819e-537a-4905-8bc5-eea0ad2803e5
      version: -1
      name: |
        azure-sentinel-threat-indicator-create
      description: creates a new threat indicator
      script: '|||azure-sentinel-threat-indicator-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      display_name:
        simple: test
      indicator_type:
        simple: domain
      threat_types:
        simple: benign
      value:
        simple: test.test
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2310,
          "y": 275
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 316e5020-52b8-4d7f-858e-7f7beca122fb
    type: regular
    task:
      id: 316e5020-52b8-4d7f-858e-7f7beca122fb
      version: -1
      name: azure-sentinel-threat-indicator-tags-append
      description: Append new tags to an existing indicator
      script: Azure Sentinel|||azure-sentinel-threat-indicator-tags-append
      type: regular
      iscommand: true
      brand: Azure Sentinel
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      name:
        simple: ${AzureSentinel.ThreatIndicator.Name}
      tags:
        simple: newTag
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2310,
          "y": 440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: 1f0c7d64-3581-4626-88be-e6340ff0ad31
    type: condition
    task:
      id: 1f0c7d64-3581-4626-88be-e6340ff0ad31
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "46"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsString
          left:
            value:
              simple: AzureSentinel.ThreatIndicator.Tags
            iscontext: true
          right:
            value:
              simple: newTag
    view: |-
      {
        "position": {
          "x": 2310,
          "y": 595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: d998e3bb-5720-49e3-8d5f-7319f5174c40
    type: regular
    task:
      id: d998e3bb-5720-49e3-8d5f-7319f5174c40
      version: -1
      name: azure-sentinel-threat-indicator-tags-replace
      description: Replace the tags of a given indicator
      script: Azure Sentinel|||azure-sentinel-threat-indicator-tags-replace
      type: regular
      iscommand: true
      brand: Azure Sentinel
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      name:
        simple: ${AzureSentinel.ThreatIndicator.Name}
      tags:
        simple: ReplaceTheTag
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2310,
          "y": 755
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: f514e670-5305-4188-82f8-175dffcd4414
    type: condition
    task:
      id: f514e670-5305-4188-82f8-175dffcd4414
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsString
          left:
            value:
              simple: AzureSentinel.ThreatIndicator.Tags
            iscontext: true
          right:
            value:
              simple: ReplaceTheTag
    view: |-
      {
        "position": {
          "x": 2310,
          "y": 925
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: da2fe7e2-afda-4ddd-8339-664b574b55c9
    type: regular
    task:
      id: da2fe7e2-afda-4ddd-8339-664b574b55c9
      version: -1
      name: azure-sentinel-threat-indicator-update
      description: Update an existing threat indicator
      script: Azure Sentinel|||azure-sentinel-threat-indicator-update
      type: regular
      iscommand: true
      brand: Azure Sentinel
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      display_name:
        simple: NewDisplayName
      indicator_type:
        simple: domain-name
      name:
        simple: ${AzureSentinel.ThreatIndicator.Name}
      value:
        simple: domain.dot
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1820,
          "y": 1530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: fb224066-c45e-4dd2-8df3-b61cef47b4d4
    type: condition
    task:
      id: fb224066-c45e-4dd2-8df3-b61cef47b4d4
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: AzureSentinel.ThreatIndicator.DisplayName
            iscontext: true
          right:
            value:
              simple: NewDisplayName
    view: |-
      {
        "position": {
          "x": 1820,
          "y": 1680
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "47_17_yes": 0.11
    },
    "paper": {
      "dimensions": {
        "height": 2760,
        "width": 2640,
        "x": 50,
        "y": -50
      }
    }
  }
inputs:
- key: incident_title
  value:
    simple: DO_NOT_TOUCH-FOR_TEST_PLAYBOOK
  required: false
  description: ""
  playbookInputQuery:
- key: watchlist_alias
  value:
    simple: TEST_PLAYBOOK_ALIAS
  required: false
  description: ""
  playbookInputQuery:
- key: test_comment
  value:
    simple: test_comment
  required: false
  description: ""
  playbookInputQuery:
outputs: []
sourceplaybookid: TestAzureSentinelPlaybook
fromversion: 5.0.0
description: ''
